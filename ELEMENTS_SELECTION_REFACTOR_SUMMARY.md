# Рефакторинг системы выбора элементов для блоков

## Описание изменений

Переработана система выбора элементов в формах редактирования и создания блоков главной страницы для улучшения пользовательского опыта и оптимизации производительности.

## Основные изменения

### 1. Создан новый компонент `ElementsSelectionDialog`
- **Файл**: `components/elements-selection-dialog.tsx`
- **Назначение**: Отдельный диалог для выбора элементов с иерархией
- **Особенности**:
  - Иерархическое отображение категорий (как в форме редактирования товара)
  - Поиск по элементам
  - Кнопки "Выбрать все" и "Очистить"
  - Поддержка всех типов элементов (категории, товары, бренды, преимущества, инфо-карточки)
  - Оптимизированная загрузка данных

### 2. Создан компонент `SelectedElementsDisplay`
- **Файл**: `components/selected-elements-display.tsx`
- **Назначение**: Отображение только выбранных элементов
- **Особенности**:
  - Показывает только выбранные элементы (по умолчанию)
  - Возможность удаления отдельных элементов
  - Кнопка "Очистить все"
  - Адаптивная высота с прокруткой
  - Отображение дополнительной информации (цены, статусы и т.д.)

### 3. Обновлен `HomepageBlockEditDialog`
- **Файл**: `components/homepage-block-edit-dialog.tsx`
- **Изменения**:
  - Удалена сложная логика отображения всех элементов
  - Добавлена кнопка "Выбрать элементы" для открытия диалога
  - Правая колонка теперь показывает только выбранные элементы
  - Упрощена структура компонента
  - Улучшена производительность

## Преимущества нового подхода

### 1. Улучшенный UX
- **Четкое разделение**: Выбор элементов происходит в отдельном диалоге
- **Иерархия для категорий**: Удобное навигация по дереву категорий
- **Фокус на выбранном**: Основная форма показывает только выбранные элементы
- **Быстрая навигация**: Не нужно искать выбранные элементы среди всех

### 2. Оптимизация производительности
- **Ленивая загрузка**: Элементы загружаются только при открытии диалога выбора
- **Меньше рендеринга**: Основная форма не отображает все элементы
- **Эффективная фильтрация**: Поиск работает только в диалоге выбора

### 3. Масштабируемость
- **Любое количество элементов**: Форма адаптируется к любому количеству выбранных элементов
- **Фиксированные размеры**: Диалоги не меняют размеры при большом количестве элементов
- **Прокрутка**: Эффективная прокрутка для больших списков

## Технические детали

### Структура компонентов
```
HomepageBlockEditDialog
├── ElementsSelectionDialog (отдельный диалог)
└── SelectedElementsDisplay (отображение выбранных)
```

### Обработка данных
- **Загрузка по требованию**: Элементы загружаются только при необходимости
- **Кэширование**: Выбранные элементы кэшируются в состоянии формы
- **Оптимизированные запросы**: Минимальное количество API-вызовов

### Адаптивность
- **Фиксированная высота диалогов**: Не зависят от количества элементов
- **Прокручиваемые области**: Эффективная работа с большими списками
- **Отзывчивый дизайн**: Адаптируется к разным размерам экрана

## Совместимость

- ✅ Поддерживает все существующие типы блоков
- ✅ Сохраняет обратную совместимость с API
- ✅ Не влияет на другие компоненты
- ✅ Использует существующие UI-компоненты

## Результат

Новая система выбора элементов обеспечивает:
- Более интуитивный пользовательский интерфейс
- Лучшую производительность при работе с большими объемами данных
- Удобную навигацию по иерархии категорий
- Оптимизированное использование пространства экрана
